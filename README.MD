<a name="readme-top"></a>

# RESTful-Transaction-API

![Badge](https://img.shields.io/badge/Node.js-18.x-green)
![Badge](https://img.shields.io/badge/Fastify-^4.x-blue)
![Badge](https://img.shields.io/badge/SQLite-3-lightgrey)
![Badge](https://img.shields.io/badge/Tested%20with-Vitest-purple)

> UMA API RESTFUL PARA CONTROLE DE TRANSAÃ‡Ã•ES FINANCEIRAS, CONSTRUÃDA COM FASTIFY, TYPESCRIPT E SQLITE.

## ğŸ“Œ DescriÃ§Ã£o

Esta aplicaÃ§Ã£o permite que usuÃ¡rios criem, listem, visualizem e resumam transaÃ§Ãµes financeiras (crÃ©dito e dÃ©bito). As transaÃ§Ãµes sÃ£o armazenadas em sessÃµes Ãºnicas, identificadas via cookies, garantindo isolamento e seguranÃ§a sem a necessidade de autenticaÃ§Ã£o.

## ğŸš€ Funcionalidades

- Criar transaÃ§Ãµes (crÃ©dito ou dÃ©bito)
- Listar todas as transaÃ§Ãµes da sessÃ£o atual
- Buscar uma transaÃ§Ã£o especÃ­fica por ID
- Gerar um resumo do saldo total da sessÃ£o

## ğŸ§ª Testes Automatizados

Testes completos para todas as rotas foram implementados com:

- **Vitest** â€“ para estrutura de testes
- **Supertest** â€“ para simulaÃ§Ã£o de requisiÃ§Ãµes HTTP
- Reset do banco de dados antes de cada teste com comandos do Knex

## ğŸ› ï¸ Principais tecnologias e ferramentas

- [Fastify](https://fastify.dev/)
- [TypeScript](https://www.typescriptlang.org/)
- [Knex.js](https://knexjs.org/)
- [SQLite](https://www.sqlite.org/index.html)
- [Zod](https://zod.dev/) â€“ validaÃ§Ã£o de dados
- [Vitest](https://vitest.dev/) + [Supertest](https://github.com/visionmedia/supertest)

## ğŸ“ Estrutura do Projeto

```env
src/
â”œâ”€â”€ app.ts # InstÃ¢ncia principal do Fastify
â”œâ”€â”€ routes/
â”‚ â””â”€â”€ transactions.ts # Rotas de transaÃ§Ãµes (CRUD + resumo)
â”œâ”€â”€ database.ts # ConfiguraÃ§Ã£o do banco via Knex
â”œâ”€â”€ env.ts # VariÃ¡veis de ambiente
â””â”€â”€ middlewares/
â””â”€â”€ check-session-id.ts # VerificaÃ§Ã£o da sessÃ£o via cookies

test/
â””â”€â”€ transactions.spec.ts # Testes automatizados das rotas
```

## âš™ï¸ Como executar

```bash
# Instale as dependÃªncias
npm install

# Rode as migrations
npm run knex migrate:latest

# Inicie o servidor em modo dev
npm run dev

A API estarÃ¡ disponÃ­vel em http://localhost:3333.

```
## ğŸ§ª Rodando os testes

```
bash

npm test
```

Durante os testes, o banco Ã© resetado a cada teste com:

```
bash

npm run knex migrate:rollback --all
npm run knex migrate:latest
```
## ğŸ“¦ Migrations com Knex.js
O banco de dados Ã© estruturado com o uso de migrations. Abaixo, os principais arquivos de schema:

âœ… CriaÃ§Ã£o da tabela transactions

```
// db/migrations/xxxx_create_transactions.ts
export async function up(knex: Knex): Promise<void> {
  await knex.schema.createTable("transactions", (table) => {
    table.uuid("id").primary();
    table.text("title").notNullable();
    table.decimal("amount", 10, 2).notNullable();
    table.timestamp("created_at").defaultTo(knex.fn.now()).notNullable();
  });
}

export async function down(knex: Knex): Promise<void> {
  await knex.schema.dropTable("transactions");
}
```

ğŸ§© AdiÃ§Ã£o do session_id com Ã­ndice
```
// db/migrations/xxxx_add_session_id.ts
export async function up(knex: Knex): Promise<void> {
  await knex.schema.alterTable("transactions", (table) => {
    table.uuid("session_id").after("id").index();
  });
}

export async function down(knex: Knex): Promise<void> {
  await knex.schema.alterTable("transactions", (table) => {
    table.dropColumn("session_id");
  });
}
```

## ğŸ¤ ContribuiÃ§Ã£o

Se vocÃª deseja contribuir com este projeto, siga estas etapas:

1. Fork o repositÃ³rio.

2. Crie uma branch para sua contribuiÃ§Ã£o:

   ```bash
   git checkout -b minha-contribuicao

   ```

3. FaÃ§a suas alteraÃ§Ãµes e commit:

   ```bash
   git commit -m 'Minha contribuiÃ§Ã£o'

   ```

4. Envie sua branch:

   ```bash
    git push origin minha-contribuicao

   ```

5. Abra uma solicitaÃ§Ã£o pull. 

## ğŸ§  Autor

israel.kilday@yahoo.com.br

[![linkedin](https://img.shields.io/badge/LinkedIn-0077B5?style=for-the-badge&logo=linkedin&logoColor=white)](https://www.linkedin.com/in/israel-kilday-machado-de-souza-801482230) <a href="mailto:israelkilday27@gmail.com">
<img src="https://img.shields.io/badge/Gmail-333333?style=for-the-badge&logo=gmail&logoColor=red" />
</a>

### Obrigado por visitar meu projeto! ğŸ‘‹

 <p align="right">(<a href="#readme-top">voltar ao topo</a>)</p>

